<!DOCTYPE html>
<html>
<head>
  <meta charset='utf-8' />
  <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no' />
  <title>Connected Devices</title>

  <!-- Mapbox Dependencies -->
  <link href='https://api.tiles.mapbox.com/mapbox.js/v2.0.0/mapbox.css' rel='stylesheet' />
  <script type="text/javascript" src='https://api.tiles.mapbox.com/mapbox.js/v2.0.0/mapbox.js'></script>
  <script type="text/javascript" src='https://api.tiles.mapbox.com/mapbox.js/plugins/leaflet-heat/v0.1.0/leaflet-heat.js'></script>

  <!-- Demo Dependencies -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js" type="text/javascript"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jQuery-Knob/1.2.13/jquery.knob.min.js" type="text/javascript"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.2.0/js/bootstrap.min.js" type="text/javascript"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet" type="text/css" />

  <!-- keen-analysis@1.2.2 -->
  <script src="https://d26b395fwzu5fz.cloudfront.net/keen-analysis-1.2.2.js" type="text/javascript"></script>

  <!-- keen-dataviz@1.1.3 -->
  <link href="https://d26b395fwzu5fz.cloudfront.net/keen-dataviz-1.1.3.css" rel="stylesheet" />
  <script src="https://d26b395fwzu5fz.cloudfront.net/keen-dataviz-1.1.3.js" type="text/javascript"></script>

  <!-- Dashboard -->
  <link rel="stylesheet" type="text/css" href="../static/keen-dashboards.css" />
  <link rel="stylesheet" type="text/css" href="../static/connected-devices.css" />
  <script src="../static/connected-devices.js" type="text/javascript"></script>
  <style>
    canvas {
      -moz-user-select: none;
      -webkit-user-select: none;
      -ms-user-select: none;
    }
    </style>
</head>
<body class="keen-dashboard" style="padding-top: 80px;">


  <div class="container-fluid">
    <div class="row">

      <div class="col-sm-6">
        <div class="chart-wrapper">
          <div class="chart-title">
            Customer Engagement
          </div>
          <div class="chart-stage">
            <table border = 1>
                <tr>
                    <th> labels </th>
                    <th> positive </th>
                    <th> negative </th>
                </tr>
                 {% for key, value in result.items() %}
                 
                    <tr>
                       <td> {{ key }} </td>
                       <td> {{ value['positive']}} </td>
                       <td> {{ value['negative'] }} </td>
                       
                    </tr>
                    
                 {% endfor %}
            </table>
          </div>
        </div>
      </div>


      <div class="col-sm-6">
        <div class="chart-wrapper">
          <div class="chart-title">
            Stats
          </div>
          <div class="chart-stage">
            <div class="row">
              <div class="col-sm-6">
                <div class="chart-title knob-title">
                  Positive Feedbacks
                </div>
                <div class="chart-stage">
                  <input type="text" class="users" id="users" value="0"/>
                </div>
              </div>
              <div class="col-sm-6">
                <div class="chart-title knob-title">
                  Negative Feedbacks
                </div>
                <div class="chart-stage">
                  <input type="text" class="errors" id="errors" value="0"/>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="row">

      <div class="col-sm-6">
        <div class="chart-wrapper">
          <div class="chart-title">
            Multibar Graph
          </div>
          <div class="chart-stage">
            <canvas id="chart" width="800" height="450"></canvas>

          </div>
          <div class="chart-notes">
          </div>
        </div>
      </div>

      <div class="col-sm-6" id="mapwrap">
        <div class="chart-wrapper">
          <div class="chart-title">
            <div class="btn-group-xs">Active Users
              <button type="button" id="7days" class="btn btn-default">7 Days</button>
              <button type="button" id="14days" class="btn btn-default">14 Days</button>
              <button type="button" id="28days" class="btn btn-default">28 Days</button>
            </div>
          </div>
          <div class="chart-stage">
            <div id="map"></div>
          </div>
          <div class="chart-notes">
          </div>
        </div>
      </div>
    </div>

  <!-- Project Analytics -->
  <script type="text/javascript" src="../static/keen-analytics.js"></script>
  <script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/1.0.2/Chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>

  <script>
  	document.getElementById("users").value = {{ result1 }};
    document.getElementById("errors").value = {{ result2 }};
    //console.log({{ result3|safe }})
   
    var received = {{ result3|safe }};
    console.log(received);
    
    var l = {{ sendlist|safe }}
    
    console.log(l);
    console.log(received[0]);
    var pos = new Array();
    var neg = new Array();
    var t1 = {}
    var t2={}
    var score = {}
    for(var i in received) {
        t1 = l[received[i]][0];
				pos.push(t1);
        t2 = l[received[i]][1];
        neg.push(t2);
				//score.push(l[received[i]][1]);
			}
      //console.log(player);
          new Chart(document.getElementById("chart"), {
      type: 'bar',
      data: {
        labels: received,
        datasets: [
          {
            label: "Positive",
            backgroundColor: "#3e95cd",
            data: pos
          }, {
            label: "Negative",
            backgroundColor: "#8e5ea2",
            data: neg
          }
        ]
      },
      options: {
        title: {
          display: true,
          text: 'Feedbacks'
        }
      }
  });
  </script>
</body>
</html>
